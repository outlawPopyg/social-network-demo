(this["webpackJsonpsamurai-1"]=this["webpackJsonpsamurai-1"]||[]).push([[0],{118:function(t,e,n){"use strict";n.d(e,"b",(function(){return a}));var r=n(22),c=n(3),s=n(31),i="SEND-MESSAGE",a=function(t){return{type:"SEND-MESSAGE",value:t}},o={messagesData:[{id:Object(s.a)(),message:"Hello, how are you?"},{id:Object(s.a)(),message:"Can you help me ? "},{id:Object(s.a)(),message:"Get my dick inside"}],dialogsData:[{id:Object(s.a)(),name:"Ivan"},{id:Object(s.a)(),name:"Andrew"},{id:Object(s.a)(),name:"Calvin"},{id:Object(s.a)(),name:"Dutch"}]};e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case i:var n=e.value;return Object(c.a)(Object(c.a)({},t),{},{messagesData:[].concat(Object(r.a)(t.messagesData),[{id:Object(s.a)(),message:n}])});default:return t}}},119:function(t,e,n){},160:function(t,e,n){},161:function(t,e,n){},185:function(t,e,n){},186:function(t,e,n){},187:function(t,e,n){},188:function(t,e,n){},189:function(t,e,n){},290:function(t,e,n){"use strict";n.r(e);var r=n(1),c=n.n(r),s=n(63),i=n.n(s),a=n(25),o=n(26),u=n(29),l=n(28),j=(n(160),n(161),n(12)),b=n(0),d=function(){return Object(b.jsxs)("nav",{children:[Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/profile",children:"Profile"})}),Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/dialogs",children:"Dialogs"})}),Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/users",children:"Users"})}),Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/music",children:"Music"})}),Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/settings",children:"Settings"})})]})},f=n(10),O=n(3),h=n(11),p=n(22),g=n(124),m=n.n(g).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"API-KEY":"d7a22d46-2b9f-4ab6-9764-bdb9ae134d6d"}}),x=function(t){var e=new FormData;return e.append("image",t),m.put("profile/photo",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){return t.data}))},v="TOGGLE-FOLLOW",S="SET-USERS",P="SET-CURRENT-PAGE",w="SET-TOTAL-USERS-COUNT",y="SET-FETCHING",C="FOLLOWING-IN-PROGRESS",k="GET-STATUS",I={users:[],pageSize:100,totalUsersCount:0,currentPage:1,isFetching:!1,followingInProgress:[],followingId:null,status:"",fake:10},T=function(t){return{type:v,userId:t}},U=function(t){return{type:y,isFetching:t}},E=function(t,e){return{type:C,followingInProgress:t,followingId:e}},D=function(t){return{type:k,status:t}},N=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case v:var n=t.users,r=n.find((function(t){return t.id===e.userId}));return Object(O.a)(Object(O.a)({},t),{},{users:[].concat(Object(p.a)(n.slice(0,n.findIndex((function(t){return t.id===e.userId})))),[Object(O.a)(Object(O.a)({},r),{},{followed:!r.followed})],Object(p.a)(n.slice(n.findIndex((function(t){return t.id===e.userId}))+1)))});case S:return Object(O.a)(Object(O.a)({},t),{},{users:e.users});case P:return Object(O.a)(Object(O.a)({},t),{},{currentPage:e.currentPage});case w:return Object(O.a)(Object(O.a)({},t),{},{totalUsersCount:e.totalUsersCount});case y:return Object(O.a)(Object(O.a)({},t),{},{isFetching:e.isFetching});case C:return Object(O.a)(Object(O.a)({},t),{},{followingInProgress:e.followingInProgress?[].concat(Object(p.a)(t.followingInProgress),[e.followingId]):t.followingInProgress.filter((function(t){return t!==e.followingId}))});case k:return Object(O.a)(Object(O.a)({},t),{},{status:e.status});default:return t}},A=(n(185),n.p+"static/media/user.55758720.png"),F=(n(186),function(){return Object(b.jsxs)("div",{className:"loader",children:[Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__ball"})]})}),_=function(t){return function(e){return e.isFetching?Object(b.jsx)(F,{}):Object(b.jsx)(t,Object(O.a)({},e))}},z=n(52),L=(n(187),c.a.memo((function(t){for(var e=t.totalUsersCount,n=t.pageSize,c=t.setCurrentPage,s=t.currentPage,i=t.portionSize,a=void 0===i?10:i,o=Object(r.useState)(1),u=Object(z.a)(o,2),l=u[0],j=u[1],d=Math.ceil(e/n),f=(l-1)*a+1,O=l*a,h=[],p=1;p<=d;p++)h.push(p);return Object(b.jsxs)(b.Fragment,{children:[l>1&&Object(b.jsx)("button",{onClick:function(){return j(l-1)},children:"left"}),Object(b.jsx)("div",{className:"numbers",children:h.slice(f-1,O).map((function(t){return Object(b.jsx)("span",{onClick:function(){return c(t)},className:t===s?"selectedPage":null,children:t},t)}))}),d>10*l-1&&Object(b.jsx)("button",{onClick:function(){return j(l+1)},children:"Right"})]})}))),M=_((function(t){var e=t.toggleFollow,n=t.followingInProgress,r=t.pageSize,c=t.totalUsersCount,s=t.users,i=t.currentPage,a=t.setCurrentPage;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{children:"UsersPage"}),Object(b.jsx)(L,{pageSize:r,totalUsersCount:c,setCurrentPage:a,currentPage:i,portionSize:10}),Object(b.jsx)("ul",{className:"list",children:s.map((function(t){var r=t.id,c=t.name,s=t.followed,i=t.photos.small;return Object(b.jsxs)("li",{className:"user",children:[Object(b.jsx)("div",{className:"image",children:Object(b.jsx)(j.b,{to:"profile/".concat(r),children:Object(b.jsx)("img",{src:null!==i?i:A,alt:"user"})})}),Object(b.jsx)("div",{children:c}),Object(b.jsx)("button",{disabled:n.some((function(t){return t===r})),onClick:function(t,n){e(r,s?"delete":"post")},children:s?"Unfollow":"Follow"})]},r)}))})]})}),"isFetching"),R=n(128),G=Object(R.a)((function(t){return t.usersPage.users}),(function(t){return t.filter((function(t){return!0}))})),B=function(t){return t.usersPage.pageSize},H=function(t){return t.usersPage.totalUsersCount},J=function(t){return t.usersPage.currentPage},W=function(t){return t.usersPage.followingInProgress},X=function(t){return t.usersPage.isFetching},Y=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(a.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.getUsers(this.props.currentPage,this.props.pageSize)}},{key:"componentDidUpdate",value:function(t,e,n){t.currentPage!==this.props.currentPage&&this.props.getUsers(this.props.currentPage,this.props.pageSize)}},{key:"render",value:function(){return Object(b.jsx)(M,Object(O.a)({},this.props))}}]),n}(r.Component),q={onToggleFollow:T,setCurrentPage:function(t){return{type:P,currentPage:t}},setFollowing:E,getUsers:function(t,e){return function(n){n(U(!0)),function(t,e){return m.get("users?page=".concat(t,"&count=").concat(e)).then((function(t){return t.data}))}(t,e).then((function(t){var e,r;n((e=t.items,{type:S,users:e})),n((r=Math.round(t.totalCount),{type:w,totalUsersCount:r}))})).finally((function(){return n(U(!1))}))}},toggleFollow:function(t,e){return function(n){n(E(!0,t)),function(t,e){return m[e]("/follow/".concat(t),{}).then((function(t){return t.data}))}(t,e).then((function(e){0===e.resultCode&&n(T(t))})).finally((function(){return n(E(!1,t))}))}}},K=Object(h.b)((function(t){return{users:G(t),pageSize:B(t),totalUsersCount:H(t),currentPage:J(t),followingInProgress:W(t),isFetching:X(t)}}),q)(Y),V=(n(188),n(42)),Z="SET-USER-DATA",Q={id:null,email:null,login:null,isAuth:!1},$=function(t,e,n,r){return{type:Z,payload:{id:t,email:e,login:n,isAuth:r}}},tt=function(){return function(t){return m.get("auth/me",{withCredentials:!0}).then((function(e){if(0===e.data.resultCode){var n=e.data.data,r=n.id,c=n.email,s=n.login;t($(r,c,s,!0))}else console.log("You are not authorized")}))}},et=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case Z:return Object(O.a)(Object(O.a)({},t),e.payload);default:return t}},nt=Object(h.b)(null,{logout:function(){return function(t){m.delete("auth/login").then((function(t){return t.data})).then((function(e){0===e.resultCode?t($(null,null,null,!1)):console.log("Something went wrong")}))}}})((function(t){var e=t.isAuth,n=t.login,r=t.logout;return Object(b.jsxs)("header",{children:[Object(b.jsx)("div",{className:"image",children:Object(b.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/a/ab/Android_O_Preview_Logo.png",alt:"logo"})}),Object(b.jsx)("div",{className:"login",children:e?Object(b.jsxs)("div",{children:[n," ",Object(b.jsx)("button",{onClick:r,children:"logout"})]}):Object(b.jsx)(j.b,{to:"/login",children:"Login"})})]})})),rt=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(a.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(b.jsx)(nt,Object(O.a)({},this.props))}}]),n}(r.Component),ct={setUserData:$,authMeThunk:tt},st=Object(h.b)((function(t){return{userId:t.auth.userId,email:t.auth.email,login:t.auth.login,isAuth:t.auth.isAuth}}),ct)(rt),it=n(120),at=n(121),ot=n(38),ut=n(35),lt=n(64),jt=Object(ut.a)(30),bt=Object(at.a)({form:"login"})((function(t){var e=t.handleSubmit,n=t.error;return Object(b.jsx)("form",{onSubmit:e,children:Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{children:Object(b.jsx)(it.a,{placeholder:"Login",name:"email",component:ot.a,validate:[ut.b,jt]})}),Object(b.jsx)("div",{children:Object(b.jsx)(it.a,{placeholder:"Password",name:"password",component:ot.a,validate:[ut.b,jt]})}),Object(b.jsxs)("div",{children:[Object(b.jsx)(it.a,{component:ot.a,type:"checkbox",name:"rememberMe"})," remember me"]}),n&&Object(b.jsx)("div",{className:"form-summary-error",children:n}),Object(b.jsx)("div",{children:Object(b.jsx)("button",{children:"Sign in"})})]})})})),dt={login:function(t){return function(e){(function(t){var e=t.email,n=t.password,r=t.rememberMe;return m.post("auth/login",{email:e,password:n,rememberMe:r}).then((function(t){return t.data}))})(t).then((function(t){if(0===t.resultCode)e(tt());else{var n=Object(V.a)("login",{_error:"Something went wrong"});e(n)}}))}}},ft=Object(h.b)(null,dt)(Object(lt.a)((function(t){var e=t.login;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{children:"Login"}),Object(b.jsx)(bt,{onSubmit:function(t){e(t)}})]})}),"profile",(function(t){return t.isAuth}))),Ot=n(9),ht={initialized:!1},pt="SET-INITIALIZE",gt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case pt:return Object(O.a)(Object(O.a)({},t),{},{initialized:!0});default:return t}},mt=n(118),xt=n(88),vt=n.n(xt),St=n(126),Pt=n(31),wt="ADD-POST",yt="SET-USER-PROFILE",Ct="DELETE-POST",kt="SET-PHOTOS-SUCCESS",It={userInfo:"",postsData:[{id:Object(Pt.a)(),message:"Hi, how are you?",likesCount:12},{id:Object(Pt.a)(),message:"It's my first post",likesCount:9}]},Tt=function(t){return{type:yt,userInfo:t}},Ut=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:It,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case Ct:var n=e.id;return Object(O.a)(Object(O.a)({},t),{},{postsData:[].concat(Object(p.a)(t.postsData.slice(0,n)),Object(p.a)(t.postsData.slice(n+1)))});case wt:var r=e.value;return Object(O.a)(Object(O.a)({},t),{},{postsData:[].concat(Object(p.a)(t.postsData),[{id:Object(Pt.a)(),message:r,likesCount:4}])});case yt:return Object(O.a)(Object(O.a)({},t),{},{userInfo:e.userInfo});case kt:return Object(O.a)(Object(O.a)({},t),{},{userInfo:Object(O.a)(Object(O.a)({},t.userInfo),e.photos)});default:return t}},Et=n(127),Dt=n(122),Nt=Object(Ot.c)({dialogsPage:mt.a,contentPage:Ut,usersPage:N,auth:et,app:gt,form:Dt.a}),At=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ot.d,Ft=Object(Ot.e)(Nt,At(Object(Ot.a)(Et.a))),_t=function(t){var e=t.status,n=t.setUserStatusThunk,c=Object(r.useState)(!1),s=Object(z.a)(c,2),i=s[0],a=s[1],o=Object(r.useState)(e),u=Object(z.a)(o,2),l=u[0],j=u[1];return Object(r.useEffect)((function(){return j(e)}),[e]),Object(b.jsxs)(b.Fragment,{children:[!i&&Object(b.jsx)("div",{children:Object(b.jsx)("span",{onDoubleClick:function(){return a(!0)},children:e||"no"})}),i&&Object(b.jsx)("div",{children:Object(b.jsx)("input",{autoFocus:!0,onBlur:function(t){a(!1),n(l)},onChange:function(t){return j(t.target.value)},value:l,type:"text"})})]})},zt=function(t){var e=t.setUserPhotoThunk,n=t.userInfo,r=t.isAuth,c=t.id,s=t.status,i=t.setUserStatusThunk,a=t.owner;if(!r)return Object(b.jsx)(f.a,{to:"/login"});if(!n)return Object(b.jsx)(F,{});var o=n.fullName,u=n.photos.large,l=n.aboutMe;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"main-image",children:[Object(b.jsx)("img",{src:u||A,alt:"main"}),a&&Object(b.jsx)("input",{type:"file",onChange:function(t){var n=t.target;n.files.length&&(console.log(n.files[0]),e(n.files[0]))}})]}),Object(b.jsx)("h1",{children:o}),Object(b.jsx)("div",{children:l}),Object(b.jsx)(_t,{status:s,id:c,setUserStatusThunk:i})]})},Lt=(n(119),function(t){var e=t.message;return Object(b.jsxs)("p",{children:["- ",e]})}),Mt=Object(ut.a)(10),Rt=c.a.memo((function(t){var e=t.postsData,n=t.onButtonClick;console.log("render");return Object(b.jsxs)("div",{children:[Object(b.jsx)(Gt,{onSubmit:function(t){var e=t.postText;return n(e)}}),Object(b.jsx)("div",{children:e.map((function(t){return Object(b.jsx)(Lt,Object(O.a)({},t),t.id)}))})]})})),Gt=Object(at.a)({form:"postsForm"})((function(t){var e=t.handleSubmit;return Object(b.jsxs)("form",{onSubmit:e,children:[Object(b.jsx)("h1",{children:"My posts"}),Object(b.jsx)(it.a,{name:"postText",type:"text",component:ot.a,validate:[ut.b,Mt]}),Object(b.jsx)("button",{className:"my-posts-button",children:"Add new post"})]})})),Bt=Rt,Ht=Object(h.b)((function(t){return{postsData:t.contentPage.postsData}}),(function(t){return{onButtonClick:function(e){return t(function(t){return{type:"ADD-POST",value:t}}(e))}}}))(Bt),Jt=function(t){return Object(b.jsxs)("div",{className:"main-content",children:[Object(b.jsx)(zt,Object(O.a)({},t)),Object(b.jsx)(Ht,{})]})},Wt=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(a.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=this.props.match.params.id,e=void 0===t?this.props.id:t;this.props.getUserProfileThunk(e),this.props.getUserStatusThunk(e)}},{key:"componentDidUpdate",value:function(t,e,n){var r=this.props.match.params.id,c=void 0===r?this.props.id:r;t.match.params.id!==c&&(this.props.getUserProfileThunk(c),this.props.getUserStatusThunk(c))}},{key:"render",value:function(){return Object(b.jsx)(Jt,Object(O.a)(Object(O.a)({},this.props),{},{owner:!this.props.match.params.id}))}}]),n}(r.Component),Xt={setUserProfile:Tt,getUserProfileThunk:function(t){return function(e){(function(t){return m.get("profile/".concat(t))})(t).then((function(t){return e(Tt(t.data))}))}},getUserStatusThunk:function(t){return function(e){(function(t){return m.get("profile/status/".concat(t)).then((function(t){return t.data}))})(t).then((function(t){return e(D(t))}))}},setUserStatusThunk:function(t){return function(e){(function(t){return m.put("profile/status",{status:t}).then((function(t){return t.data}))})(t).then((function(n){return e(D(t))}))}},setUserPhotoThunk:function(t){return function(){var e=Object(St.a)(vt.a.mark((function e(n){var r;return vt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:0===(r=e.sent).resultCode&&n((c=r.data,{type:kt,photos:c}));case 4:case"end":return e.stop()}var c}),e)})));return function(t){return e.apply(this,arguments)}}()}},Yt=Object(Ot.d)(Object(h.b)((function(t){return{userInfo:t.contentPage.userInfo,id:t.auth.id,isAuth:t.auth.isAuth,status:t.usersPage.status}}),Xt),f.f)(Object(lt.a)(Wt,"login",(function(t){return!t.isAuth}))),qt=c.a.lazy((function(){return n.e(3).then(n.bind(null,292))})),Kt=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(){return Object(a.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.initializeApp()}},{key:"render",value:function(){return this.props.initialized?Object(b.jsxs)("div",{className:"app-wrapper",children:[Object(b.jsx)(st,{}),Object(b.jsx)(d,{}),Object(b.jsxs)("div",{className:"app-wrapper-content",children:[Object(b.jsx)(f.b,{exact:!0,path:"/dialogs",render:function(){return Object(b.jsx)(r.Suspense,{fallback:Object(b.jsx)("div",{children:"Loading..."}),children:Object(b.jsx)(qt,{})})}}),Object(b.jsx)(f.b,{path:"/profile/:id?",component:Yt}),Object(b.jsx)(f.b,{exact:!0,path:"/users",component:K}),Object(b.jsx)(f.b,{exact:!0,path:"/login",render:function(){return Object(b.jsx)(ft,{})}})]})]}):Object(b.jsx)(F,{})}}]),n}(c.a.Component),Vt=Object(Ot.d)(f.f,Object(h.b)((function(t){return{initialized:t.app.initialized}}),{initializeApp:function(){return function(t){Promise.all([t(tt())]).then((function(){return t({type:pt})}))}}}))(Kt),Zt=function(){return Object(b.jsx)(h.a,{store:Ft,children:Object(b.jsx)(j.a,{children:Object(b.jsx)(Vt,{})})})};i.a.render(Object(b.jsx)(Zt,{}),document.getElementById("root"))},35:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}));var r=function(t){if(!t)return"Required field"},c=function(t){return function(e){if(e&&e.length>t)return"Max length ".concat(t)}}},38:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n(3),c=n(129),s=(n(1),n(189),n(0)),i=["input","meta"],a=function(t){return function(e){var n=e.input,a=e.meta,o=Object(c.a)(e,i),u=a.error,l=a.touched,j=u&&l;return Object(s.jsxs)("div",{className:"form-control ".concat(j?"error":""),children:[Object(s.jsx)(t,Object(r.a)(Object(r.a)({},n),o)),j&&Object(s.jsx)("span",{children:u})]})}},o=a((function(t){return Object(s.jsx)("textarea",Object(r.a)({},t))})),u=a((function(t){return Object(s.jsx)("input",Object(r.a)({},t))}))},64:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3),c=(n(1),n(10)),s=n(11),i=n(0),a=function(t){return{isAuth:t.auth.isAuth}},o=function(t,e,n){return Object(s.b)(a)((function(s){return n(s)?Object(i.jsx)(c.a,{to:"/".concat(e)}):Object(i.jsx)(t,Object(r.a)({},s))}))}}},[[290,1,2]]]);
//# sourceMappingURL=main.ea223022.chunk.js.map