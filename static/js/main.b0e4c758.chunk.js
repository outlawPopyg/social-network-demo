(this["webpackJsonpsamurai-1"]=this["webpackJsonpsamurai-1"]||[]).push([[0],{117:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(22),c=n(3),i=n(31),s="SEND-MESSAGE",a=function(e){return{type:"SEND-MESSAGE",value:e}},o={messagesData:[{id:Object(i.a)(),message:"Hello, how are you?"},{id:Object(i.a)(),message:"Can you help me ? "},{id:Object(i.a)(),message:"Get my dick inside"}],dialogsData:[{id:Object(i.a)(),name:"Ivan"},{id:Object(i.a)(),name:"Andrew"},{id:Object(i.a)(),name:"Calvin"},{id:Object(i.a)(),name:"Dutch"}]};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s:var n=t.value;return Object(c.a)(Object(c.a)({},e),{},{messagesData:[].concat(Object(r.a)(e.messagesData),[{id:Object(i.a)(),message:n}])});default:return e}}},118:function(e,t,n){},158:function(e,t,n){},159:function(e,t,n){},183:function(e,t,n){},184:function(e,t,n){},185:function(e,t,n){},186:function(e,t,n){},187:function(e,t,n){},287:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),i=n(63),s=n.n(i),a=n(25),o=n(26),u=n(29),l=n(28),j=(n(158),n(159),n(12)),b=n(0),d=function(){return Object(b.jsxs)("nav",{children:[Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/profile",children:"Profile"})}),Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/dialogs",children:"Dialogs"})}),Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/users",children:"Users"})}),Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/music",children:"Music"})}),Object(b.jsx)("div",{children:Object(b.jsx)(j.b,{to:"/settings",children:"Settings"})})]})},O=n(10),f=n(3),h=n(11),g=n(22),p=n(123),m=n.n(p).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"API-KEY":"d7a22d46-2b9f-4ab6-9764-bdb9ae134d6d"}}),x="TOGGLE-FOLLOW",v="SET-USERS",S="SET-CURRENT-PAGE",P="SET-TOTAL-USERS-COUNT",w="SET-FETCHING",y="FOLLOWING-IN-PROGRESS",C="GET-STATUS",I={users:[],pageSize:100,totalUsersCount:0,currentPage:1,isFetching:!1,followingInProgress:[],followingId:null,status:"",fake:10},k=function(e){return{type:x,userId:e}},E=function(e){return{type:w,isFetching:e}},T=function(e,t){return{type:y,followingInProgress:e,followingId:t}},U=function(e){return{type:C,status:e}},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:var n=e.users,r=n.find((function(e){return e.id===t.userId}));return Object(f.a)(Object(f.a)({},e),{},{users:[].concat(Object(g.a)(n.slice(0,n.findIndex((function(e){return e.id===t.userId})))),[Object(f.a)(Object(f.a)({},r),{},{followed:!r.followed})],Object(g.a)(n.slice(n.findIndex((function(e){return e.id===t.userId}))+1)))});case v:return Object(f.a)(Object(f.a)({},e),{},{users:t.users});case S:return Object(f.a)(Object(f.a)({},e),{},{currentPage:t.currentPage});case P:return Object(f.a)(Object(f.a)({},e),{},{totalUsersCount:t.totalUsersCount});case w:return Object(f.a)(Object(f.a)({},e),{},{isFetching:t.isFetching});case y:return Object(f.a)(Object(f.a)({},e),{},{followingInProgress:t.followingInProgress?[].concat(Object(g.a)(e.followingInProgress),[t.followingId]):e.followingInProgress.filter((function(e){return e!==t.followingId}))});case C:return Object(f.a)(Object(f.a)({},e),{},{status:t.status});case"FAKE":return Object(f.a)(Object(f.a)({},e),{},{fake:e.fake+1});default:return e}},D=(n(183),n.p+"static/media/user.55758720.png"),A=(n(184),function(){return Object(b.jsxs)("div",{className:"loader",children:[Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__bar"}),Object(b.jsx)("div",{className:"loader__ball"})]})}),F=function(e){return function(t){return t.isFetching?Object(b.jsx)(A,{}):Object(b.jsx)(e,Object(f.a)({},t))}},_=n(52),z=(n(185),c.a.memo((function(e){for(var t=e.totalUsersCount,n=e.pageSize,c=e.setCurrentPage,i=e.currentPage,s=e.portionSize,a=void 0===s?10:s,o=Object(r.useState)(1),u=Object(_.a)(o,2),l=u[0],j=u[1],d=Math.ceil(t/n),O=(l-1)*a+1,f=l*a,h=[],g=1;g<=d;g++)h.push(g);return Object(b.jsxs)(b.Fragment,{children:[l>1&&Object(b.jsx)("button",{onClick:function(){return j(l-1)},children:"left"}),Object(b.jsx)("div",{className:"numbers",children:h.slice(O-1,f).map((function(e){return Object(b.jsx)("span",{onClick:function(){return c(e)},className:e===i?"selectedPage":null,children:e},e)}))}),d>10*l-1&&Object(b.jsx)("button",{onClick:function(){return j(l+1)},children:"Right"})]})}))),L=F((function(e){var t=e.toggleFollow,n=e.followingInProgress,r=e.pageSize,c=e.totalUsersCount,i=e.users,s=e.currentPage,a=e.setCurrentPage;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{children:"UsersPage"}),Object(b.jsx)(z,{pageSize:r,totalUsersCount:c,setCurrentPage:a,currentPage:s,portionSize:10}),Object(b.jsx)("ul",{className:"list",children:i.map((function(e){var r=e.id,c=e.name,i=e.followed,s=e.photos.small;return Object(b.jsxs)("li",{className:"user",children:[Object(b.jsx)("div",{className:"image",children:Object(b.jsx)(j.b,{to:"profile/".concat(r),children:Object(b.jsx)("img",{src:null!==s?s:D,alt:"user"})})}),Object(b.jsx)("div",{children:c}),Object(b.jsx)("button",{disabled:n.some((function(e){return e===r})),onClick:function(e,n){t(r,i?"delete":"post")},children:i?"Unfollow":"Follow"})]},r)}))})]})}),"isFetching"),M=n(126),R=Object(M.a)((function(e){return e.usersPage.users}),(function(e){return e.filter((function(e){return!0}))})),G=function(e){return e.usersPage.pageSize},B=function(e){return e.usersPage.totalUsersCount},H=function(e){return e.usersPage.currentPage},J=function(e){return e.usersPage.followingInProgress},K=function(e){return e.usersPage.isFetching},W=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.getUsers(this.props.currentPage,this.props.pageSize)}},{key:"componentDidUpdate",value:function(e,t,n){e.currentPage!==this.props.currentPage&&this.props.getUsers(this.props.currentPage,this.props.pageSize)}},{key:"render",value:function(){return Object(b.jsx)(L,Object(f.a)({},this.props))}}]),n}(r.Component),X={onToggleFollow:k,setCurrentPage:function(e){return{type:S,currentPage:e}},setFollowing:T,getUsers:function(e,t){return function(n){n(E(!0)),function(e,t){return m.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))}(e,t).then((function(e){var t,r;n((t=e.items,{type:v,users:t})),n((r=Math.round(e.totalCount),{type:P,totalUsersCount:r}))})).finally((function(){return n(E(!1))}))}},toggleFollow:function(e,t){return function(n){n(T(!0,e)),function(e,t){return m[t]("/follow/".concat(e),{}).then((function(e){return e.data}))}(e,t).then((function(t){0===t.resultCode&&n(k(e))})).finally((function(){return n(T(!1,e))}))}}},Y=Object(h.b)((function(e){return{users:R(e),pageSize:G(e),totalUsersCount:B(e),currentPage:H(e),followingInProgress:J(e),isFetching:K(e)}}),X)(W),q=(n(186),n(42)),V="SET-USER-DATA",Z={id:null,email:null,login:null,isAuth:!1},Q=function(e,t,n,r){return{type:V,payload:{id:e,email:t,login:n,isAuth:r}}},$=function(){return function(e){return m.get("auth/me",{withCredentials:!0}).then((function(t){if(0===t.data.resultCode){var n=t.data.data,r=n.id,c=n.email,i=n.login;e(Q(r,c,i,!0))}else console.log("You are not authorized")}))}},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V:return Object(f.a)(Object(f.a)({},e),t.payload);default:return e}},te=Object(h.b)(null,{logout:function(){return function(e){m.delete("auth/login").then((function(e){return e.data})).then((function(t){0===t.resultCode?e(Q(null,null,null,!1)):console.log("Something went wrong")}))}}})((function(e){var t=e.isAuth,n=e.login,r=e.logout;return Object(b.jsxs)("header",{children:[Object(b.jsx)("div",{className:"image",children:Object(b.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/a/ab/Android_O_Preview_Logo.png",alt:"logo"})}),Object(b.jsx)("div",{className:"login",children:t?Object(b.jsxs)("div",{children:[n," ",Object(b.jsx)("button",{onClick:r,children:"logout"})]}):Object(b.jsx)(j.b,{to:"/login",children:"Login"})})]})})),ne=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(b.jsx)(te,Object(f.a)({},this.props))}}]),n}(r.Component),re={setUserData:Q,authMeThunk:$},ce=Object(h.b)((function(e){return{userId:e.auth.userId,email:e.auth.email,login:e.auth.login,isAuth:e.auth.isAuth}}),re)(ne),ie=n(119),se=n(120),ae=n(38),oe=n(35),ue=n(64),le=Object(oe.a)(30),je=Object(se.a)({form:"login"})((function(e){var t=e.handleSubmit,n=e.error;return Object(b.jsx)("form",{onSubmit:t,children:Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{children:Object(b.jsx)(ie.a,{placeholder:"Login",name:"email",component:ae.a,validate:[oe.b,le]})}),Object(b.jsx)("div",{children:Object(b.jsx)(ie.a,{placeholder:"Password",name:"password",component:ae.a,validate:[oe.b,le]})}),Object(b.jsxs)("div",{children:[Object(b.jsx)(ie.a,{component:ae.a,type:"checkbox",name:"rememberMe"})," remember me"]}),n&&Object(b.jsx)("div",{className:"form-summary-error",children:n}),Object(b.jsx)("div",{children:Object(b.jsx)("button",{children:"Sign in"})})]})})})),be={login:function(e){return function(t){(function(e){var t=e.email,n=e.password,r=e.rememberMe;return m.post("auth/login",{email:t,password:n,rememberMe:r}).then((function(e){return e.data}))})(e).then((function(e){if(0===e.resultCode)t($());else{var n=Object(q.a)("login",{_error:"Something went wrong"});t(n)}}))}}},de=Object(h.b)(null,be)(Object(ue.a)((function(e){var t=e.login;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{children:"Login"}),Object(b.jsx)(je,{onSubmit:function(e){t(e)}})]})}),"profile",(function(e){return e.isAuth}))),Oe=n(9),fe={initialized:!1},he="SET-INITIALIZE",ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he:return Object(f.a)(Object(f.a)({},e),{},{initialized:!0});default:return e}},pe=n(117),me=n(31),xe="ADD-POST",ve="SET-USER-PROFILE",Se="DELETE-POST",Pe={userInfo:"",postsData:[{id:Object(me.a)(),message:"Hi, how are you?",likesCount:12},{id:Object(me.a)(),message:"It's my first post",likesCount:9}]},we=function(e){return{type:ve,userInfo:e}},ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Se:var n=t.id;return Object(f.a)(Object(f.a)({},e),{},{postsData:[].concat(Object(g.a)(e.postsData.slice(0,n)),Object(g.a)(e.postsData.slice(n+1)))});case xe:var r=t.value;return Object(f.a)(Object(f.a)({},e),{},{postsData:[].concat(Object(g.a)(e.postsData),[{id:Object(me.a)(),message:r,likesCount:4}])});case ve:return Object(f.a)(Object(f.a)({},e),{},{userInfo:t.userInfo});default:return e}},Ce=n(125),Ie=n(121),ke=Object(Oe.c)({dialogsPage:pe.a,contentPage:ye,usersPage:N,auth:ee,app:ge,form:Ie.a}),Ee=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Oe.d,Te=Object(Oe.e)(ke,Ee(Object(Oe.a)(Ce.a))),Ue=function(e){var t=e.status,n=e.setUserStatusThunk,c=Object(r.useState)(!1),i=Object(_.a)(c,2),s=i[0],a=i[1],o=Object(r.useState)(t),u=Object(_.a)(o,2),l=u[0],j=u[1];return Object(r.useEffect)((function(){return j(t)}),[t]),Object(b.jsxs)(b.Fragment,{children:[!s&&Object(b.jsx)("div",{children:Object(b.jsx)("span",{onDoubleClick:function(){return a(!0)},children:t||"no"})}),s&&Object(b.jsx)("div",{children:Object(b.jsx)("input",{autoFocus:!0,onBlur:function(e){a(!1),n(l)},onChange:function(e){return j(e.target.value)},value:l,type:"text"})})]})},Ne=function(e){var t=e.userInfo,n=e.isAuth,r=e.id,c=e.status,i=e.setUserStatusThunk;if(!n)return Object(b.jsx)(O.a,{to:"/login"});if(!t)return Object(b.jsx)(A,{});var s=t.fullName,a=t.photos.large,o=t.aboutMe;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"main-image",children:Object(b.jsx)("img",{src:a,alt:"main"})}),Object(b.jsx)("h1",{children:s}),Object(b.jsx)("div",{children:o}),Object(b.jsx)(Ue,{status:c,id:r,setUserStatusThunk:i})]})},De=(n(118),function(e){var t=e.message;return Object(b.jsxs)("p",{children:["- ",t]})}),Ae=Object(oe.a)(10),Fe=c.a.memo((function(e){var t=e.postsData,n=e.onButtonClick;console.log("render");return Object(b.jsxs)("div",{children:[Object(b.jsx)(_e,{onSubmit:function(e){var t=e.postText;return n(t)}}),Object(b.jsx)("div",{children:t.map((function(e){return Object(b.jsx)(De,Object(f.a)({},e),e.id)}))})]})})),_e=Object(se.a)({form:"postsForm"})((function(e){var t=e.handleSubmit;return Object(b.jsxs)("form",{onSubmit:t,children:[Object(b.jsx)("h1",{children:"My posts"}),Object(b.jsx)(ie.a,{name:"postText",type:"text",component:ae.a,validate:[oe.b,Ae]}),Object(b.jsx)("button",{className:"my-posts-button",children:"Add new post"})]})})),ze=Fe,Le=Object(h.b)((function(e){return{postsData:e.contentPage.postsData}}),(function(e){return{onButtonClick:function(t){return e(function(e){return{type:"ADD-POST",value:e}}(t))}}}))(ze),Me=function(e){return Object(b.jsxs)("div",{className:"main-content",children:[Object(b.jsx)(Ne,Object(f.a)({},e)),Object(b.jsx)(Le,{})]})},Re=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.id,t=void 0===e?this.props.id:e;this.props.getUserProfileThunk(t),this.props.getUserStatusThunk(t)}},{key:"render",value:function(){return Object(b.jsx)(Me,Object(f.a)({},this.props))}}]),n}(r.Component),Ge={setUserProfile:we,getUserProfileThunk:function(e){return function(t){(function(e){return m.get("profile/".concat(e))})(e).then((function(e){return t(we(e.data))}))}},getUserStatusThunk:function(e){return function(t){(function(e){return m.get("profile/status/".concat(e)).then((function(e){return e.data}))})(e).then((function(e){return t(U(e))}))}},setUserStatusThunk:function(e){return function(t){(function(e){return m.put("profile/status",{status:e}).then((function(e){return e.data}))})(e).then((function(n){return t(U(e))}))}}},Be=Object(Oe.d)(Object(h.b)((function(e){return{userInfo:e.contentPage.userInfo,id:e.auth.id,isAuth:e.auth.isAuth,status:e.usersPage.status}}),Ge),O.f)(Object(ue.a)(Re,"login",(function(e){return!e.isAuth}))),He=c.a.lazy((function(){return n.e(3).then(n.bind(null,289))})),Je=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.initializeApp()}},{key:"render",value:function(){return this.props.initialized?Object(b.jsxs)("div",{className:"app-wrapper",children:[Object(b.jsx)(ce,{}),Object(b.jsx)(d,{}),Object(b.jsxs)("div",{className:"app-wrapper-content",children:[Object(b.jsx)(O.b,{exact:!0,path:"/dialogs",render:function(){return Object(b.jsx)(r.Suspense,{fallback:Object(b.jsx)("div",{children:"Loading..."}),children:Object(b.jsx)(He,{})})}}),Object(b.jsx)(O.b,{path:"/profile/:id?",component:Be}),Object(b.jsx)(O.b,{exact:!0,path:"/users",component:Y}),Object(b.jsx)(O.b,{exact:!0,path:"/login",render:function(){return Object(b.jsx)(de,{})}})]})]}):Object(b.jsx)(A,{})}}]),n}(c.a.Component),Ke=Object(Oe.d)(O.f,Object(h.b)((function(e){return{initialized:e.app.initialized}}),{initializeApp:function(){return function(e){Promise.all([e($())]).then((function(){return e({type:he})}))}}}))(Je),We=function(){return Object(b.jsx)(h.a,{store:Te,children:Object(b.jsx)(j.a,{children:Object(b.jsx)(Ke,{})})})};s.a.render(Object(b.jsx)(We,{}),document.getElementById("root"))},35:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return c}));var r=function(e){if(!e)return"Required field"},c=function(e){return function(t){if(t&&t.length>e)return"Max length ".concat(e)}}},38:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var r=n(3),c=n(127),i=(n(1),n(187),n(0)),s=["input","meta"],a=function(e){return function(t){var n=t.input,a=t.meta,o=Object(c.a)(t,s),u=a.error,l=a.touched,j=u&&l;return Object(i.jsxs)("div",{className:"form-control ".concat(j?"error":""),children:[Object(i.jsx)(e,Object(r.a)(Object(r.a)({},n),o)),j&&Object(i.jsx)("span",{children:u})]})}},o=a((function(e){return Object(i.jsx)("textarea",Object(r.a)({},e))})),u=a((function(e){return Object(i.jsx)("input",Object(r.a)({},e))}))},64:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3),c=(n(1),n(10)),i=n(11),s=n(0),a=function(e){return{isAuth:e.auth.isAuth}},o=function(e,t,n){return Object(i.b)(a)((function(i){return n(i)?Object(s.jsx)(c.a,{to:"/".concat(t)}):Object(s.jsx)(e,Object(r.a)({},i))}))}}},[[287,1,2]]]);
//# sourceMappingURL=main.b0e4c758.chunk.js.map